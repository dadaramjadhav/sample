main file modified by dmj
